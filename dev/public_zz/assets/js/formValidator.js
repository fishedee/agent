var jQuery_formValidator_initConfig;!function($){$.formValidator={sustainType:function(a,b){var c=$("#"+a).get(0),d=c.tagName,e=c.type;switch(b.validatetype){case"InitValidator":return!0;case"InputValidator":return"INPUT"==d||"TEXTAREA"==d||"SELECT"==d?!0:!1;case"CompareValidator":return"INPUT"==d||"TEXTAREA"==d?"checkbox"==e||"radio"==e?!1:!0:!1;case"AjaxValidator":return"text"==e||"textarea"==e||"file"==e||"password"==e||"select-one"==e?!0:!1;case"RegexValidator":return"INPUT"==d||"TEXTAREA"==d?"checkbox"==e||"radio"==e?!1:!0:!1;case"FunctionValidator":return!0}},initConfig:function(a){var b={debug:!1,validatorgroup:"1",alertmessage:!1,validobjectids:"",forcevalid:!1,onsuccess:function(){return!0},onerror:function(){},submitonce:!1,formid:"",autotip:!1,tidymode:!1,errorfocus:!0,wideword:!0};a=a||{},$.extend(b,a),b.tidymode&&(b.errorfocus=!1),""!=b.formid&&$("#"+b.formid).submit(function(){return $.formValidator.pageIsValid("1")}),null==jQuery_formValidator_initConfig&&(jQuery_formValidator_initConfig=new Array),jQuery_formValidator_initConfig.push(b)},appendValid:function(a,b){if(!$.formValidator.sustainType(a,b))return-1;var c=$("#"+a).get(0);("InitValidator"==b.validatetype||void 0==c.settings)&&(c.settings=new Array);var d=c.settings.push(b);return c.settings[d-1].index=d-1,d-1},getInitConfig:function(a){if(null!=jQuery_formValidator_initConfig)for(i=0;i<jQuery_formValidator_initConfig.length;i++)if(a==jQuery_formValidator_initConfig[i].validatorgroup)return jQuery_formValidator_initConfig[i];return null},triggerValidate:function(a){switch(a.setting.validatetype){case"InputValidator":$.formValidator.inputValid(a);break;case"CompareValidator":$.formValidator.compareValid(a);break;case"AjaxValidator":$.formValidator.ajaxValid(a);break;case"RegexValidator":$.formValidator.regexValid(a);break;case"FunctionValidator":$.formValidator.functionValid(a)}},setTipState:function(a,b,c){var d=a.settings[0],e=$.formValidator.getInitConfig(d.validatorgroup),f=$("#"+d.tipid);null==c||""==c?f.hide():(e.tidymode&&($("#fv_content").html(c),a.Tooltip=c,"onError"!=b&&f.hide()),f.removeClass(),f.addClass(b),f.html(c))},resetTipState:function(a){var b=$.formValidator.getInitConfig(a);$(b.validobjectids).each(function(){$.formValidator.setTipState(this,"onShow",this.settings[0].onshow)})},setFailState:function(a,b){var c=$("#"+a);c.removeClass(),c.addClass("onError"),c.html(b)},showMessage:function(a){var b=a.id,c=$("#"+b).get(0),d=a.isvalid,e=a.setting,f="",g="",h=$("#"+b).get(0).settings,i=$.formValidator.getInitConfig(h[0].validatorgroup);if(d)f=$.formValidator.isEmpty(b)?e.onempty:e.oncorrect,$.formValidator.setTipState(c,"onCorrect",f);else if(g="onError","AjaxValidator"==e.validatetype?""==e.lastValid?(g="onLoad",f=e.onwait):f=e.onerror:f=""==a.errormsg?e.onerror:a.errormsg,i.alertmessage){var c=$("#"+b).get(0);c.validoldvalue!=$(c).val()&&alert(f)}else $.formValidator.setTipState(c,g,f);return f},showAjaxMessage:function(a){var b=a.setting,c=$("#"+a.id).get(0);(c.settings[a.ajax].cached?c.validoldvalue==$(c).val():0)?(void 0==b.isvalid||b.isvalid||(c.lastshowclass="onError",c.lastshowmsg=b.onerror),$.formValidator.setTipState(c,c.lastshowclass,c.lastshowmsg)):$.formValidator.ajaxValid(a)},getLength:function(a){var b=$("#"+a),c=b.get(0);sType=c.type;var d=0;switch(sType){case"text":case"hidden":case"password":case"textarea":case"file":var e=b.val(),f=$.formValidator.getInitConfig(c.settings[0].validatorgroup);if(f.wideword)for(var g=0;g<e.length;g++)e.charCodeAt(g)>=19968&&e.charCodeAt(g)<=40869?d+=2:d++;else d=e.length;break;case"checkbox":case"radio":d=$("input[type='"+sType+"'][name='"+b.attr("name")+"']:checked").length;break;case"select-one":d=c.options?c.options.selectedIndex:-1;break;case"select-multiple":d=$("select[name="+c.name+"] option:selected").length}return d},isEmpty:function(a){return $("#"+a).get(0).settings[0].empty&&0==$.formValidator.getLength(a)?!0:!1},isOneValid:function(a){return $.formValidator.oneIsValid(a,1).isvalid},oneIsValid:function(a){var b=new Object;b.id=a,b.ajax=-1,b.errormsg="";var c=$("#"+a).get(0),d=c.settings,e=d.length;if(1==e&&(d[0].bind=!1),!d[0].bind)return null;for(var f=0;e>f;f++)if(0!=f){if(b.setting=d[f],"AjaxValidator"!=d[f].validatetype?$.formValidator.triggerValidate(b):b.ajax=f,!d[f].isvalid){b.isvalid=!1,b.setting=d[f];break}if(b.isvalid=!0,b.setting=d[0],"AjaxValidator"==d[f].validatetype)break}else if($.formValidator.isEmpty(a)){b.isvalid=!0,b.setting=d[0];break}return b},pageIsValid:function(a){(null==a||void 0==a)&&(a="1");var b,c,d=!0,e="",f="^",g=$.formValidator.getInitConfig(a),h=$(g.validobjectids);if(h.each(function(a,h){if(h.settings[0].bind&&(c=$.formValidator.oneIsValid(h.id,1))){var i=h.settings[0].tipid;c.isvalid||(d=!1,""==e&&(e=c.id,b=""==c.errormsg?c.setting.onerror:c.errormsg)),g.alertmessage||-1==f.indexOf("^"+i+"^")&&(c.isvalid||(f=f+i+"^"),$.formValidator.showMessage(c))}}),d)d=g.onsuccess(),g.submitonce&&$("input[type='submit']").attr("disabled",!0);else{var i=$("#"+e).get(0);g.onerror(b,i),""!=e&&g.errorfocus&&$("#"+e).focus()}return!g.debug&&d},ajaxValid:function(a){var b=a.id,c=$("#"+b),d=c.get(0),e=d.settings,f=e[a.ajax],g=f.url;if(0==c.size()&&e[0].empty)return a.setting=e[0],a.isvalid=!0,$.formValidator.showMessage(a),void(f.isvalid=!0);if(f.addidvalue){var h="clientid="+b+"&"+b+"="+encodeURIComponent(c.val());f.getdata&&$.each(f.getdata,function(a,b){h+="&"+a+"="+$("#"+b).val()}),g+=g.indexOf("?")>-1?"&"+h:"?"+h,"undefined"!=typeof pc_hash&&(g+=g.indexOf("?")>-1?"&pc_hash="+pc_hash:"?pc_hash="+pc_hash)}$.ajax({mode:"abort",type:f.type,url:g,cache:f.cache,data:f.data,async:f.async,dataType:f.datatype,success:function(a){f.success(a)?($.formValidator.setTipState(d,"onCorrect",e[0].oncorrect),f.isvalid=!0):($.formValidator.setTipState(d,"onError",f.onerror),f.isvalid=!1)},complete:function(){f.buttons&&f.buttons.length>0&&f.buttons.attr({disabled:!1}),f.complete},beforeSend:function(b){f.buttons&&f.buttons.length>0&&f.buttons.attr({disabled:!0});var c=f.beforesend(b);return c&&(f.isvalid=!1,$.formValidator.setTipState(d,"onLoad",e[a.ajax].onwait)),f.lastValid="-1",c},error:function(){$.formValidator.setTipState(d,"onError",f.onerror),f.isvalid=!1,f.error()},processData:f.processdata})},regexValid:function(returnObj){var id=returnObj.id,setting=returnObj.setting,srcTag=$("#"+id).get(0).tagName,elem=$("#"+id).get(0);if(elem.settings[0].empty&&""==elem.value)setting.isvalid=!0;else{var regexpress=setting.regexp;if("enum"==setting.datatype&&(regexpress=eval("regexEnum."+regexpress)),void 0==regexpress||""==regexpress)return void(setting.isvalid=!1);setting.isvalid=new RegExp(regexpress,setting.param).test($("#"+id).val())}},functionValid:function(a){var b=a.id,c=a.setting,d=$("#"+b),e=c.fun(d.val(),d.get(0));void 0!=e&&("string"==typeof e?(c.isvalid=!1,a.errormsg=e):c.isvalid=e)},inputValid:function(a){var b=a.id,c=a.setting,d=$("#"+b),e=d.get(0),f=d.val(),g=e.type,h=$.formValidator.getLength(b),i=c.empty,j=!1;switch(g){case"text":case"hidden":case"password":case"textarea":case"file":"size"==c.type&&(i=c.empty,i.leftempty||(j=f.replace(/^[ \s]+/,"").length!=f.length),j||i.rightempty||(j=f.replace(/[ \s]+$/,"").length!=f.length),j&&i.emptyerror&&(a.errormsg=i.emptyerror));case"checkbox":case"select-one":case"select-multiple":case"radio":var k=!1;("select-one"==g||"select-multiple"==g)&&(c.type="size");var l=c.type;if("size"==l)j||(k=!0),k&&(f=h);else if("date"==l||"datetime"==l){"date"==l&&(k=isDate(f)),"datetime"==l&&(k=isDate(f)),k&&(f=new Date(f),c.min=new Date(c.min),c.max=new Date(c.max))}else stype=typeof c.min,"number"==stype&&(f=new Number(f).valueOf(),isNaN(f)||(k=!0)),"string"==stype&&(k=!0);c.isvalid=!1,k&&(f<c.min||f>c.max?(f<c.min&&c.onerrormin&&(a.errormsg=c.onerrormin),f>c.min&&c.onerrormax&&(a.errormsg=c.onerrormax)):c.isvalid=!0)}},compareValid:function(a){var b=a.id,c=a.setting,d=$("#"+b),e=$("#"+c.desid),f=c.datatype;if(c.isvalid=!1,curvalue=d.val(),ls_data=e.val(),"number"==f){if(isNaN(curvalue)||isNaN(ls_data))return;curvalue=parseFloat(curvalue),ls_data=parseFloat(ls_data)}if("date"==f||"datetime"==f){var g=!1;if("date"==f&&(g=isDate(curvalue)&&isDate(ls_data)),"datetime"==f&&(g=isDateTime(curvalue)&&isDateTime(ls_data)),!g)return;curvalue=new Date(curvalue),ls_data=new Date(ls_data)}switch(c.operateor){case"=":curvalue==ls_data&&(c.isvalid=!0);break;case"!=":curvalue!=ls_data&&(c.isvalid=!0);break;case">":curvalue>ls_data&&(c.isvalid=!0);break;case">=":curvalue>=ls_data&&(c.isvalid=!0);break;case"<":ls_data>curvalue&&(c.isvalid=!0);break;case"<=":ls_data>=curvalue&&(c.isvalid=!0)}},localTooltip:function(a){a=a||window.event;var b=a.pageX||(a.clientX?a.clientX+document.body.scrollLeft:0),c=a.pageY||(a.clientY?a.clientY+document.body.scrollTop:0);$("#fvtt").css({top:c+2+"px",left:b-40+"px"})}},$.fn.formValidator=function(a){var b={validatorgroup:"1",empty:!1,submitonce:!1,automodify:!1,onshow:"请输入内容",onfocus:"请输入内容",oncorrect:"输入正确",onempty:"输入内容为空",defaultvalue:null,bind:!0,validatetype:"InitValidator",tipcss:{left:"10px",top:"1px",height:"20px",width:"250px"},triggerevent:"blur",forcevalid:!1};a=a||{},void 0==a.validatorgroup&&(a.validatorgroup="1");var c=$.formValidator.getInitConfig(a.validatorgroup);return c.tidymode&&(b.tipcss={left:"2px",width:"22px",height:"22px",display:"none"}),$.extend(!0,b,a),this.each(function(){var a=$(this),d={};$.extend(!0,d,b);var e=d.tipid?d.tipid:this.id+"Tip";c.autotip&&(0==$("body [id="+e+"]").length&&(aftertip=d.relativeid?d.relativeid:this.id,$("#"+aftertip).parent().append("<div id='"+e+"'></div>")),c.tidymode&&a.showTooltips()),b.tipid=e,$.formValidator.appendValid(this.id,b);var f=c.validobjectids;-1==f.indexOf("#"+this.id+" ")&&(c.validobjectids=""==f?"#"+this.id:f+",#"+this.id),c.alertmessage||$.formValidator.setTipState(this,"onShow",b.onshow);var g=this.tagName.toLowerCase(),h=(this.type,b.defaultvalue);h&&a.val(h),"input"==g||"textarea"==g?(a.focus(function(){if(!c.alertmessage){var a=$("#"+e);this.lastshowclass=a.attr("class"),this.lastshowmsg=a.html(),$.formValidator.setTipState(this,"onFocus",b.onfocus)}}),a.bind(b.triggerevent,function(){var a=(this.settings,$.formValidator.oneIsValid(this.id,1));if(null!=a)if(a.ajax>=0)$.formValidator.showAjaxMessage(a);else{var d=$.formValidator.showMessage(a);if(!a.isvalid){var e=b.automodify&&("text"==this.type||"textarea"==this.type||"file"==this.type);e&&!c.alertmessage?(alert(d),$.formValidator.setTipState(this,"onShow",b.onshow)):(c.forcevalid||b.forcevalid)&&(alert(d),this.focus())}}})):"select"==g&&(a.bind("focus",function(){c.alertmessage||$.formValidator.setTipState(this,"onFocus",b.onfocus)}),a.bind("blur",function(){a.trigger("change")}),a.bind("change",function(){var a=$.formValidator.oneIsValid(this.id,1);null!=a&&(a.ajax>=0?$.formValidator.showAjaxMessage(a):$.formValidator.showMessage(a))}))})},$.fn.inputValidator=function(a){var b={isvalid:!1,min:0,max:99999999999999,type:"size",onerror:"输入错误",validatetype:"InputValidator",empty:{leftempty:!0,rightempty:!0,leftemptyerror:null,rightemptyerror:null},wideword:!0};return a=a||{},$.extend(!0,b,a),this.each(function(){$.formValidator.appendValid(this.id,b)})},$.fn.compareValidator=function(a){var b={isvalid:!1,desid:"",operateor:"=",onerror:"输入错误",validatetype:"CompareValidator"};return a=a||{},$.extend(!0,b,a),this.each(function(){$.formValidator.appendValid(this.id,b)})},$.fn.regexValidator=function(a){var b={isvalid:!1,regexp:"",param:"i",datatype:"string",onerror:"输入的格式不正确",validatetype:"RegexValidator"};return a=a||{},$.extend(!0,b,a),this.each(function(){$.formValidator.appendValid(this.id,b)})},$.fn.functionValidator=function(a){var b={isvalid:!0,fun:function(){this.isvalid=!0},validatetype:"FunctionValidator",onerror:"输入错误"};return a=a||{},$.extend(!0,b,a),this.each(function(){$.formValidator.appendValid(this.id,b)})},$.fn.ajaxValidator=function(a){var b={isvalid:!1,lastValid:"",type:"GET",url:"",addidvalue:!0,datatype:"html",data:"",async:!0,cache:!1,cached:!0,getdata:"",beforesend:function(){return!0},success:function(){return!0},complete:function(){},processdata:!1,error:function(){},buttons:null,onerror:"服务器校验没有通过",onwait:"正在等待服务器返回数据",validatetype:"AjaxValidator"};return a=a||{},$.extend(!0,b,a),this.each(function(){$.formValidator.appendValid(this.id,b)})},$.fn.defaultPassed=function(a){return this.each(function(){for(var b=this.settings,c=1;c<b.length;c++)if(b[c].isvalid=!0,!$.formValidator.getInitConfig(b[0].validatorgroup).alertmessage){var d=a?"onShow":"onCorrect";$.formValidator.setTipState(this,d,b[0].oncorrect)}})},$.fn.unFormValidator=function(a){return this.each(function(){this.settings[0].bind=!a,a?$("#"+this.settings[0].tipid).hide():$("#"+this.settings[0].tipid).show()})},$.fn.showTooltips=function(){return 0==$("body [id=fvtt]").length&&(fvtt=$("<div id='fvtt' style='position:absolute;z-index:56002'></div>"),$("body").append(fvtt),fvtt.before("<iframe src='about:blank' class='fv_iframe' scrolling='no' frameborder='0'></iframe>")),this.each(function(){jqobj=$(this),s=$("<span class='top' id=fv_content style='display:block'></span>"),b=$("<b class='bottom' style='display:block' />"),this.tooltip=$("<span class='fv_tooltip' style='display:block'></span>").append(s).append(b).css({filter:"alpha(opacity:95)",KHTMLOpacity:"0.95",MozOpacity:"0.95",opacity:"0.95"}),jqobj.mouseover(function(a){$("#fvtt").append(this.tooltip),$("#fv_content").html(this.Tooltip),$.formValidator.localTooltip(a)}),jqobj.mouseout(function(){$("#fvtt").empty()}),jqobj.mousemove(function(a){$("#fv_content").html(this.Tooltip),$.formValidator.localTooltip(a)})})}}(jQuery);