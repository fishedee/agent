!function(global,document,undefined){var DataTable=function(){this.version="v1.0",this.columnCount=0,this.isFirstLoad=!0,this.finalOptions=null};DataTable.fn=DataTable.prototype={constructor:DataTable,initDataTable:function(a){var b={yearPrefix:"_t",chainPrefix:"_h",isThresh:!1,order:"asc",thorder:{}};for(var c in a)b[c]=a[c],this[c]=a[c];if(b.hasOwnProperty("allFields")){var d={};if(b.checkAll){d.gri_checkAll={};for(var c in b.allFields)d[c]=b.allFields[c];b.allFields=d}}else if(b.allFields={},b.checkAll&&(b.allFields.gri_checkAll={}),b.data.length>0)for(var e in b.data[0])b.allFields[e]={};b.noPage&&(b.page=!1),this.summary==undefined&&(this.summary=[]),this.options=b,this.createTable(b);return this},createTable:function(a){var b="",c=a.THFields,d=a.allFields,e=document.getElementById(a.tableId),f="DIV"==e.nodeName,g=f?document.getElementById(a.tableId):e.parentNode;for(var h in d)d[h].needOrder==undefined&&(d[h].needOrder=!1);if(f){g.innerHTML="",e.className=a.cssSetting&&a.cssSetting.containerClass!=undefined?a.cssSetting.containerClass:"gri_wrapper";var i=document.createElement("TABLE");i.className+=a.cssSetting&&a.cssSetting.tableClass!=undefined?a.cssSetting.tableClass:"gri_stable";var j=0,k=a.noPage?a.noPage.orderField:a.page.orderField,l=a.noPage?a.noPage.orderType:a.page.orderType,m=!1;if(document.all){var n=document.createElement("COLGROUP"),o=document.createElement("THEAD"),p=document.createElement("TR"),q=document.createElement("TBODY");for(var h in d){var r=document.createElement("COL");r.className+="gri_"+h,d[h].width&&parseInt(d[h].width)>0&&(r.style.width=d[h].width),n.appendChild(r);var s=document.createElement("TH"),t=document.createElement("span");if("gri_checkAll"!=h)t.className="label",t.innerHTML=d[h].thText?d[h].thText:h;else{var u=document.createElement("input");u.type="checkbox",u.className="gri_checkAll",s.appendChild(u)}a.thAlign&&(s.style.textAlign=a.thAlign);var v=document.createElement("I");a.thorder[j]!=undefined?v.className="desc"==a.thorder[j]?a.page.ifRealPage?"icon-orderd":"icon-orderu":a.page.ifRealPage?"icon-orderu":"icon-orderd":h==k&&this.isFirstLoad?v.className="asc"==l?"icon-orderu":"icon-orderd":0!=d[h].needOrder&&0!=a.enableThClick&&"gri_checkAll"!=h&&(v.className="icon-order-hover"),0!=d[h].needOrder&&0!=a.enableThClick&&"gri_checkAll"!=h&&(this.addClassName(s,"hover enable"),t.appendChild(v)),d[h].clicked&&0==m&&this.addClassName(s,"visited"),s.appendChild(t),p.appendChild(s),j++}o.appendChild(p),n.setAttribute("SPAN",j),i.appendChild(n),i.appendChild(o),i.appendChild(q),e=i}else{var w="",x="";for(var h in d){if(w+="<col",d[h].width&&parseInt(d[h].width)>0&&(w+=" style='width:"+d[h].width+"'"),w+=' class="gri_',w+=h,w+='">',"gri_checkAll"!=h){var y="",z=" visited";0!=d[h].needOrder?0!=a.enableThClick&&(y="hover enable"):z="visited",d[h].clicked&&0==m&&(y+=z,m=!0),d[h].thText?(x+="<th",a.thAlign&&(x+=" style='text-align:"+a.thAlign+"'"),x+=' class="'+y+'"><span class="label">'+d[h].thText):(x+="<th",x+=' class="'+y+'"><span class="label">'+h),a.thorder[j]!=undefined?x+="desc"==a.thorder[j]?a.page&&a.page.ifRealPage?"<i class='icon-orderd'></i>":"<i class='icon-orderu'></i>":a.page&&a.page.ifRealPage?"<i class='icon-orderu'></i>":"<i class='icon-orderd'></i>":h==k&&this.isFirstLoad?x+="asc"==l?"<i class='icon-orderu'></i>":"<i class='icon-orderd'></i>":0!=d[h].needOrder&&0!=a.enableThClick&&(x+="<i class='icon-order-hover'></i>"),x+="</span></th>"}else x+='<th><input type="checkbox" class ="gri_checkAll" /> </th>';j++}var A='<colgroup span="';A+=j,A+='">',A+=w,A+="</colgroup><thead><tr>",A+=x,A+="</tr></thead><tbody></tbody>",i.innerHTML=A,e.innerHTML=i.outerHTML,e=i}this.columnCount=j}else{var e=document.getElementById(a.tableId),n=e.getElementsByTagName("colgroup")[0];n&&(this.columnCount=n.getAttribute("span"))}if(!this.page||!this.page.container){var B=g.getElementsByTagName("DIV");B.length>0&&B[0].parentNode.removeChild(B[0])}if(this.page){"object"!=typeof this.page&&(this.page={}),this.page.size=this.page.size||10;var C=this.page.ifRealPage?this.page.rowCount:a.data.length;this.rowCount=C,parseInt(this.page.size)<parseInt(C)?this.page.count=Math.ceil(C/this.page.size):(this.page.data=a.data.slice(0,this.page.size),this.page.count=1),this.page.index=this.page.index||0,this.page.offset=this.page.offset||5;var D=this.createPage();"object"==typeof D&&g.appendChild(D),this.page.data=this.page.ifRealPage?a.data.slice(0,this.page.size):a.data.slice(this.page.index*this.page.size,(this.page.index+1)*this.page.size)}else this.page={},this.page.data=a.data;if(0==this.page.data.length)for(var E in d)d[E].value||(d[E].value=E);for(var F=0;F<this.summary.length;F++)this.page.data.push(this.summary[F]);for(var F=0;F<this.page.data.length;F++){var G=this.page.data[F],H="";for(var E in d){var I=this.Formater.colNormalFormater,J=d[E];J.value||(J.value=E);var K=G[J.value];if("gri_checkAll"==J.value&&(K="<input type='checkbox' class='gri_td_checkbox' value='"+G[a.keyIndex]+"' />"),(null==K||K==undefined||"null"==K||"undefined"==K)&&(K=""),J.length&&parseInt(J.length)>0){var L=K;K=this.setString(K,J.length)}if("function"==typeof J.format&&(K=J.format(K,L)),J.number?K=this.numberFormat(K,J.precision,J.token):J.date?K=this.dateFormat(K,J.formater):J.str&&(K=this.strFormat(K,J.reg)),J.colAlign&&(K="<div style='width: 100%; height: 100%;text-align:"+J.colAlign+";'>"+K+"</div>"),c&&E in c){var M=G[J.value+a.yearPrefix],N=G[J.value+a.chainPrefix];M=parseFloat(M),N=parseFloat(N),M=this.threshFormat(M,G[J.value],a.threshOldType,!1,a.isThresh),N=this.threshFormat(N,G[J.value],a.threshOldType,!0,a.isThresh),H+=this.colFormat({data:K,year:M,chain:N})}else{var O={};if(J.truncate){var P=this.truncate({value:K,truncate:J.truncate});P.truncated&&(I=this.Formater.colTruncateFormater),O.title=G[J.value],O.data=P.value}else O.data=K;H+=this.colFormat(O,I)}}H=this.rowFormat({row:H}),"asc"==a.order?b+=H:b=H+b}var q=e.getElementsByTagName("TBODY")[0];if(document.all){e.removeChild(q);var Q=document.createElement("TBODY");if(0==a.data.length){var R=document.createElement("p");R.style.lineHeight="50px",R.style.textAlign="center",R.innerHTML="没有相应的数据";var S=document.createElement("td");S.colSpan=this.columnCount,S.appendChild(R);var p=document.createElement("tr");p.className="gri_listtd",p.appendChild(S),Q.appendChild(p)}else{for(var T=[];b.length>0;){var U=b.substring(4,b.indexOf("</tr>"));b=b.replace("<tr>"+U+"</tr>",""),T.push(U)}for(var F=0;F<T.length;F++){var V=document.createElement("TR");F%2==1&&(V.className="gri_listtd");for(var U=T[F];U.length>0;){var W=U.substring(4,U.indexOf("</td>"));U=U.replace("<td>"+W+"</td>","");var X=document.createElement("TD");X.innerHTML=decodeURIComponent(W),V.appendChild(X)}Q.appendChild(V)}}if(e.appendChild(Q),f){var Y=g.getElementsByTagName("TABLE")[0];Y&&g.removeChild(Y);var Z=B?B[0]:this.page.container;Z?g.insertBefore(e,Z):g.appendChild(e)}}else{q.innerHTML=a.data.length>0?b:'<tr><td colspan="'+this.columnCount+'"><p style="line-height: 50px; text-align: center; ">没有相应的数据</p></td></tr>',f&&(g.getElementsByTagName("TABLE")[0].innerHTML=q.parentNode.outerHTML);for(var $=g.getElementsByTagName("TABLE")[0].getElementsByTagName("tr"),F=0;F<$.length;F++)F%2==1&&"gri_listtd"==$[F].className}for(var _=g.getElementsByTagName("TABLE")[0],ab=_.getElementsByTagName("TR"),bb=this,F=0;F<ab.length;F++){var p=ab[F];p.onclick=function(){"gri_tr_clicked"==this.className?bb.removeClassName(this,"gri_tr_clicked"):(bb.removeClassName(this,"gri_tr_clicked"),bb.addClassName(this,"gri_tr_clicked"))}}i&&this.options.complexHeader&&this.createComplexHeader(this.options.complexHeader,_,this),a.data.length>0&&a.layout&&_!=undefined&&(g.getElementsByTagName("TABLE")[0].style.tableLayout=a.layout),undefined!=a.spanColIndex&&this.tableRowsSpan(_,a.spanColIndex);var bb=this;if(this.initTh(bb,_),bb.options.page){var cb=bb.getElementsByClassName(null,_.parentNode,"select","gri_datatable_rownum");cb&&cb.length>0&&(cb[0].value=bb.page.size,cb[0].onchange=function(){bb.options.page.index=0,bb.options.page.size=cb[0].value,bb.options.page.ifRealPage?bb.createJsonTable(bb):bb.initDataTable(bb.options)})}if(a.checkAll){var db=bb.getElementsByClassName(null,_.parentNode,"input","gri_checkAll");db&&db.length>0&&(db[0].onclick=function(){for(var a=bb.getElementsByClassName(null,_.parentNode,"input","gri_td_checkbox"),b=a.length,c=0;b>c;c++)"checkbox"==a[c].type&&"disabled"!=a[c].getAttribute("disabled")&&1!=a[c].getAttribute("disabled")&&(a[c].checked=db[0].checked)})}if(bb.isFirstLoad&&bb.options.autotips){var eb=document.createElement("div");eb.className="gri_autotipsdiv",document.body.appendChild(eb)}bb.isFirstLoad&&(bb.isFirstLoad=!1,this.finalOptions=bb.options),a.callback&&a.callback(a.callbackParam?a.callbackParam.value:bb.resultObj)},createPage:function(){if(this.page.index<this.page.count){this.page.container=this.page.container||document.createElement("DIV"),this.page.container.innerHTML="",this.page.container.className=this.page.containerClass||"page cf",this.page.currentClass=this.page.currentClass||"current",this.page.nextClass=this.page.nextClass||"next",this.page.prevClass=this.page.prevClass||"prev",this.page.dotClass=this.page.dotClass||"dot";var a=this;if(this.page){var b=document.createElement("div");b.className="pg",this.page.container.appendChild(b);var c=document.createElement("A");c.className="first",c.innerHTML="<i class='i_pg_f'></i>",a.addEvent(c,"click",function(){a.page.index=0,a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options)}),c.setAttribute("href","javascript:void(0);"),b.appendChild(c)}if(this.page.count>this.page.offset){var d=document.createElement("A");d.className=this.page.prevClass,d.innerHTML='<i class="i_pg_l"></i>',this.addEvent(d,"click",function(){a.page.index=a.page.index-1,a.page.index<0||(a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options))}),d.setAttribute("href","javascript:void(0);"),b.appendChild(d)}var e=Math.floor(this.page.offset/2),f=this.page.index-e;f=0>f?0:f+this.page.offset>this.page.count?this.page.count-this.page.offset:f;var g=f+this.page.offset;g>this.page.count&&(g=this.page.count);for(var h=f;g>h;h++)if(h>=0){var d=null;h==this.page.index?(d=document.createElement("STRONG"),d.className=this.page.currentClass):d=document.createElement("A"),d.innerHTML=1+h,function(b){var c=b;a.addEvent(d,"click",function(){a.page.index=c,a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options)})}(h),d.setAttribute("href","javascript:void(0);"),b.appendChild(d)}if(this.page.count>g){if(this.page.count>g+1){var i=document.createElement("span");i.className=this.page.dotClass,i.innerHTML="...",b.appendChild(i)}var d=document.createElement("A");d.innerHTML=this.page.count,this.addEvent(d,"click",function(){a.page.index=a.page.count-1,a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options)}),d.setAttribute("href","javascript:void(0);"),b.appendChild(d)}if(this.page.count>this.page.offset){var d=document.createElement("A");d.className=this.page.nextClass,d.innerHTML='<i class="i_pg_n"></i>',this.addEvent(d,"click",function(){var b=a.page.index+1;b!=a.page.count&&(a.page.index=a.page.index+1,a.page.index>a.page.count-1||(a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options)))}),d.setAttribute("href","javascript:void(0);"),b.appendChild(d)}var j=document.createElement("A");j.innerHTML="<i class='i_pg_e'></i>",this.addEvent(j,"click",function(){a.page.index=a.page.count-1,a.page.ifRealPage?a.createJsonTable(a):a.createTable(a.options)}),j.setAttribute("href","javascript:void(0);"),b.appendChild(j);var k=document.createElement("div");k.className="show";var l="red";this.page.countColor&&(l=this.page.countColor),k.innerHTML="共<em>"+this.rowCount+"</em>条记录，每页显示";var m=document.createElement("span");return m.className="gri_datatable_pg_rowcount",m.innerHTML="<select class='gri_datatable_rownum ipt_show '><option value='5'>5</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='30'>30</option><option value='50'>50</option><option value='80'>80</option><option value='100'>100</option><option value='200'>200</option></select> 条",k.appendChild(m),this.page.container.appendChild(k),this.page.autoHide&&parseInt(this.page.rowCount)<=parseInt(this.page.size)&&(this.page.container.style.display="none"),this.page.container}},getElementAbsPos:function(a){for(var b=a.offsetTop,c=a.offsetLeft;a=a.offsetParent;)b+=a.offsetTop,c+=a.offsetLeft;return{left:c,top:b}},createJsonTable:function(_this){var _table=document.getElementById(_this.options.tableId),positon=_this.getElementAbsPos(_table),loadingDiv=document.createElement("div");loadingDiv.className="gri_datatable_loading",loadingDiv.innerHTML="<img src='/public/assets/css/images/loading.gif' alt='加载中...' />",document.getElementsByTagName("body")[0].appendChild(loadingDiv),loadingDiv.style.position="absolute",loadingDiv.style.left=positon.left+_table.clientWidth/2+"px",loadingDiv.style.top=positon.top+120+"px",loadingDiv.style.zIndex="1000";var _pageFrom=_this.page.index*_this.page.size,paramStr="pageFrom="+_pageFrom+"&pageSize="+_this.page.size+"&orderField="+_this.page.orderField+"&orderType="+_this.page.orderType+"&t="+Math.random(),sendUrl=_this.page.url;sendUrl=_this.page.url.indexOf("?")>0?sendUrl+"&"+paramStr:sendUrl+"?"+paramStr,_this.ajaxGet(sendUrl,function(result,_this){var resultObj=eval("("+result+")");_this.resultObj=resultObj,resultObj.data?(_this.options.data=resultObj.data,_this.options.callbackParam&&(_this.options.callbackParam.value=resultObj[_this.options.callbackParam.key])):(_this.options.data=resultObj,_this.options.callbackParam&&(_this.options.callbackParam.value=resultObj[_this.options.callbackParam.key])),loadingDiv.parentNode.removeChild(loadingDiv),_this.initDataTable(_this.options)},_this)},index:function(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c]==a)return c},addEvent:function(a,b,c){b=b.replace("on",""),document.addEventListener?a.addEventListener(b,c,!1):document.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},ajaxGet:function(a,b,c){var d,e=function(){if(4==d.readyState&&200==d.status){var a=d.responseText;try{b(a,c)}catch(e){}}4==d.readyState&&401==d.status&&window.location.reload()},f=function(a,b){try{d=new XMLHttpRequest}catch(c){try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){return!1}}}d.onreadystatechange=b,d.open("GET",a,!0),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.send(null)};f(a,e)},isNumber:function(a){return a=this.stripHTML(a),/^(0|[1-9][0-9]*)(\.[0-9]+)?$/.test(a)},isFloat:function(a){return/^(0|[1-9][0-9]*)\.[0-9]+$/.test(a)},isInt:function(a){return/^(0|[1-9][0-9]*)$/.test(a)},truncate:function(a){if(!a.truncate)return{value:a.value,truncated:!1};for(var b=0,c=0,d=0;d<a.value.length;d++)b+=a.value.charCodeAt(d)>256?2:1,12>=b&&(c=d);return b>a.truncate?{value:a.value.substring(0,a.truncate)+"...",truncated:!0}:{value:a.value,truncated:!1}},Formater:{colFormater:"<td>{$data}{$chain}{$year}</td>",colNormalFormater:"<td>{$data}</td>",colTruncateFormater:"<td title='{$title}'>{$data}</td>",rowFormater:"<tr>{$row}</tr>",colRiseFormater:"<em>{$value}</em>",colFallFormater:"<b>{$value}</b>"},dateFormat:function(a,b){var c=/^(\d{2,4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})$/g;c.lastIndex=0;var d=c.exec(a);return d?b.replace("y",d[1]).replace("M",d[2]).replace("d",d[3]).replace("h",d[4]).replace("m",d[5]).replace("s",d[6]):a},numberFormat:function(a,b,c){a=a.toString();var d=this.stripHTML(a),e=b||0;if(this.isNumber(d)){var f=parseFloat(d).toFixed(e);f+="";for(var g=f.split("."),h=parseInt(g[0].length/3),i="",j="",k=0;h>k;k++)i=i+",$"+(k+1),j+="(\\d{3})";return j=new RegExp(j+"$"),g[0]=g[0].replace(j,i).replace(/^,/,""),d!=a?a.replace(">"+d+"<",">"+g.join(".")+"<"):a.replace(d,g.join("."))}return a},strFormat:function(a,b){var c=a.replace(b,"");return c},colFormat:function(a,b){var c=b||this.Formater.colFormater;for(var d in a){var e=new RegExp("\\{\\$"+d+"\\}","g");c=document.all?c.replace(e,encodeURIComponent(a[d])):c.replace(e,a[d])}return c},threshFormat:function(a,b,c,d,e){var f=(e||0)&&this.threshOld[b]&&this.threshOld[b][c];if(e&&!f)return"";var g="";return a>0&&a>f?g=this.Formater.colRiseFormater:0>a&&-1*a>f&&(g=this.Formater.colFallFormater),a=a.toFixed(1)+"%",a=d?"("+a+")":"["+a+"]",g=g&&g.replace(/\{\$value\}/g,a),g=g||a},rowFormat:function(a){var b=this.Formater.rowFormater;for(var c in a){var d=new RegExp("\\{\\$"+c+"\\}","g");b=b.replace(d,a[c])}return b},tableRowsSpan:function(a,b){for(var c=b.split(","),d=a.rows.length,e=c.length-1;e>=0;e--)for(var f="",g="",h=1,i=0;d>=i;i++)if(i!=d){var g=a.rows[i].cells[c[e]].innerHTML;""!=g&&g==f?h+=1:(h>1&&this.spanRows(a,i,h,c[e]),f=g,h=1)}else h>1&&this.spanRows(a,i,h,c[e]),f=g,h=1},spanRows:function(a,b,c,d){a.rows[b-c].cells[d].rowSpan=c,a.rows[b-c].cells[d].className+="gri_td_rowSpan";for(var e=b-c+1;b-1>=e;e++)a.rows[e].deleteCell(d)},getCookie:function(a){if(document.cookie.length>0){var b=document.cookie.indexOf(a+"=");if(-1!=b){b=b+a.length+1;var c=document.cookie.indexOf(";",b);return-1==c&&(c=document.cookie.length),unescape(document.cookie.substring(b,c))}}return""},setCookie:function(a,b,c){var d=new Date;d.setDate(d.getDate()+c),document.cookie=a+"="+escape(b)+(null==c?"":"; expires="+d.toGMTString())},createComplexHeader:function(a,b,c){var d=document.createElement("THEAD");for(var e in a){for(var f=a[e],g=document.createElement("TR"),h=0;h<f.length;h++){var i=document.createElement("TH"),j=f[h].field;if(f[h].enable&&(c.addClassName(i,"hover"),c.addClassName(i,"enable")),c.options.checkAll&&"gri_checkAll"==j){var k=document.createElement("input");k.type="checkbox",k.className="gri_checkAll",i.appendChild(k)}else i.innerHTML=j?c.options.allFields[j].thText:f[h].thText;f[h].rowSpan&&(i.rowSpan=f[h].rowSpan),f[h].colSpan&&(i.colSpan=f[h].colSpan),i.style.textAlign="center",i.style.border="1px solid gainsboro",g.appendChild(i)}d.appendChild(g)}var l=b.getElementsByTagName("THEAD")[0];l&&l.parentNode.removeChild(l);var m=b.getElementsByTagName("TBODY")[0];m.parentNode.insertBefore(d,m)},initTh:function(a,b){for(var c=b.getElementsByTagName("th"),d=0;d<c.length;d++)c[d].innerHTML.indexOf("checkbox")<0&&c[d].className.indexOf("enable")>-1&&!function(b){var d=c[b];if(0!=a.options.enableThClick)d.onclick=function(){var e,f=a.index(d,c),g=0,h=a.options.thorder[b];h?"desc"==h?a.options.thorder[b]="asc":"asc"==h&&(a.options.thorder[b]="desc"):(h="asc",a.options.thorder[b]="desc");for(var i=0;i<c.length;i++)i!=b&&delete a.options.thorder[i];var j="";if(a.options.complexHeader)for(var k in a.options.allFields){var l=a.options.allFields[k].thText?a.options.allFields[k].thText:k;l==d.innerHTML&&(e=a.options.allFields[k],j=k),a.options.allFields[k].clicked=!1}else for(var k in a.options.allFields)g==f&&(e=a.options.allFields[k],j=k),a.options.allFields[k].clicked=!1,g++;if(e&&(a.page.orderField=e.value,a.options.allFields[j].clicked=!0,a.page.orderType=a.options.thorder[b]),a.page.ifRealPage)a.createJsonTable(a);else{var m=null;!a.options.page&&a.options.data.length>0&&a.options.fixedRow&&(m=a.options.data[a.options.data.length-1][e.value]),a.options.data.sort(function(b,c){var d,f;return d=null==b[e.value]?"":b[e.value].toString(),f=null==c[e.value]?"":c[e.value].toString(),d.indexOf("%")==d.length-1&&(d=d.replace("%","")),f.indexOf("%")==f.length-1&&(f=f.replace("%","")),d==m?1:f==m?-1:(a.isNumber(d)&&a.isNumber(f)&&(d=parseFloat(d),f=parseFloat(f)),"asc"==h?d>f?1:f>d?-1:0:"desc"==h?d>f?-1:f>d?1:0:void 0)}),a.initDataTable(a.options)}};else{var e=d.getElementsByTagName("I")[0];e&&e.parentNode.removeChild(e)}d.onmouseout=function(){a.removeClassName(d,"visited")},d.onmousedown=function(){return!1}}(d)},stripHTML:function(a){var b=/(<([^>]+)>)/gi;return a.toString().replace(b,"")},addClassName:function(a,b){a.className+=(a.className?" ":"")+b},getClassNames:function(a){return a.className.replace(/\s+/," ").split(" ")},removeClassName:function(a,b){for(var c=this.getClassNames(a),d=c.length,e=d-1;e>=0;e--)c[e]===b&&delete c[e];return a.className=c.join(" "),d==c.length?!1:!0},getElementsByClassName:function(a,b,c,d){node=a&&document.getElementById(a)||document,b&&(node=b),c=c||"*",d=d.split(" ");for(var e=d.length,f=0,g=e;g>f;f++)d[f]=new RegExp("(^|\\s)"+d[f].replace(/\-/g,"\\-")+"(\\s|$)");for(var h=node.getElementsByTagName(c),i=[],f=0,g=h.length,j=0;g>f;f++){for(var k=h[f];d[j++].test(k.className);)if(j===e){i[i.length]=k;break}j=0}return i},setString:function(a,b){for(var c=0,d="",e=0;e<a.length;e++)if(a.charCodeAt(e)>128?c+=2:c++,d+=a.charAt(e),c>=b)return d+"…";return d},createSuperTable:function(a,b){var c={width:"640px",height:"320px",margin:"10px",padding:"0px",overflow:"hidden",colWidths:undefined,fixedCols:0,headerRows:1,onStart:function(){},onFinish:function(){},cssSkin:"sSky"};a.width&&(c.width=a.width),a.height&&(c.height=a.height),a.fixedCols&&(c.fixedCols=a.fixedCols);var d=document.getElementById(b),e=document.createElement("div");e.id=b+"_box",d.parentNode.appendChild(e),e.appendChild(d);var f={fixedCols:{},headerRows:{},onStart:{},onFinish:{},cssSkin:{},colWidths:{}};for(var g in c)f[g]||(d.parentNode.style[g]=c[g],delete c[g]);new superTable(b,c)}},global.GRI=global.GRI||{},global.GRI.initDataTable=function(a){return(new DataTable).initDataTable(a)},global.GRI.ajaxGet=function(a,b,c){(new DataTable).ajaxGet(a,b,c)},document.all||("undefined"!=typeof HTMLElement&&(HTMLElement.prototype.__defineSetter__("outerHTML",function(a){var b=this.ownerDocument.createRange();b.setStartBefore(this);var c=b.createContextualFragment(a);return this.parentNode.replaceChild(c,this),a}),HTMLElement.prototype.__defineGetter__("outerHTML",function(){for(var a=this.attributes,b="<"+this.tagName,c=0;c<a.length;c++)a[c].specified&&(b+=" "+a[c].name+'="'+a[c].value+'"');return this.canHaveChildren?b+">"+this.innerHTML+"</"+this.tagName+">":b+" />"}),HTMLElement.prototype.__defineGetter__("canHaveChildren",function(){return!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(this.tagName.toLowerCase())})),(document.getBoxObjectFor||null!=window.mozInnerScreenX)&&(HTMLElement.prototype.__defineSetter__("innerText",function(a){var b=document.createTextNode(a);return this.innerHTML="",this.appendChild(b),b}),HTMLElement.prototype.__defineGetter__("innerText",function(){var a=this.ownerDocument.createRange();return a.selectNodeContents(this),a.toString()})))}(this,document,void 0);var superTable=function(a,b){b=b||{},this.cssSkin=b.cssSkin||"",this.headerRows=parseInt(b.headerRows||"1"),this.fixedCols=parseInt(b.fixedCols||"0"),this.colWidths=b.colWidths||[],this.initFunc=b.onStart||null,this.callbackFunc=b.onFinish||null,this.initFunc&&this.initFunc(),this.sBase=document.createElement("DIV"),this.sFHeader=this.sBase.cloneNode(!1),this.sHeader=this.sBase.cloneNode(!1),this.sHeaderInner=this.sBase.cloneNode(!1),this.sFData=this.sBase.cloneNode(!1),this.sFDataInner=this.sBase.cloneNode(!1),this.sData=this.sBase.cloneNode(!1),this.sColGroup=document.createElement("COLGROUP"),this.sDataTable=document.getElementById(a),this.sDataTable.style.margin="0px",""!==this.cssSkin&&(this.sDataTable.className+=" "+this.cssSkin),this.sDataTable.getElementsByTagName("COLGROUP").length>0&&this.sDataTable.removeChild(this.sDataTable.getElementsByTagName("COLGROUP")[0]),this.sParent=this.sDataTable.parentNode,this.sParentHeight=this.sParent.offsetHeight,this.sParentWidth=this.sParent.offsetWidth,this.sBase.className="sBase",this.sFHeader.className="sFHeader",this.sHeader.className="sHeader",this.sHeaderInner.className="sHeaderInner",this.sFData.className="sFData",this.sFDataInner.className="sFDataInner",this.sData.className="sData";var c,d,e,f,g,h,i,j;for(this.sHeaderTable=this.sDataTable.cloneNode(!1),this.sDataTable.tHead?(c=this.sDataTable.tHead,this.sHeaderTable.appendChild(c.cloneNode(!1)),d=this.sHeaderTable.tHead):(c=this.sDataTable.tBodies[0],this.sHeaderTable.appendChild(c.cloneNode(!1)),d=this.sHeaderTable.tBodies[0]),c=c.rows,g=0;g<this.headerRows;g++)d.appendChild(c[g].cloneNode(!0));for(this.sHeaderInner.appendChild(this.sHeaderTable),this.fixedCols>0&&(this.sFHeaderTable=this.sHeaderTable.cloneNode(!0),this.sFHeader.appendChild(this.sFHeaderTable),this.sFDataTable=this.sDataTable.cloneNode(!0),this.sFDataInner.appendChild(this.sFDataTable)),c=this.sDataTable.tBodies[0].rows,g=0,h=c.length;h>g;g++){for(e=!0,i=0,j=c[g].cells.length;j>i;i++)if(1!==c[g].cells[i].colSpan||1!==c[g].cells[i].rowSpan){g+=c[g].cells[i].rowSpan-1,e=!1;break}if(e===!0)break}for(f=e===!0?g:0,g=0,h=c[f].cells.length;h>g;g++)(g===this.colWidths.length||-1===this.colWidths[g])&&(this.colWidths[g]=c[f].cells[g].offsetWidth);for(g=0,h=this.colWidths.length;h>g;g++)this.sColGroup.appendChild(document.createElement("COL")),this.sColGroup.lastChild.setAttribute("width",this.colWidths[g]);this.sDataTable.insertBefore(this.sColGroup.cloneNode(!0),this.sDataTable.firstChild),this.sHeaderTable.insertBefore(this.sColGroup.cloneNode(!0),this.sHeaderTable.firstChild),this.fixedCols>0&&(this.sFDataTable.insertBefore(this.sColGroup.cloneNode(!0),this.sFDataTable.firstChild),this.sFHeaderTable.insertBefore(this.sColGroup.cloneNode(!0),this.sFHeaderTable.firstChild)),""!==this.cssSkin&&(this.sDataTable.className+=" "+this.cssSkin+"-Main",this.sHeaderTable.className+=" "+this.cssSkin+"-Headers",this.fixedCols>0&&(this.sFDataTable.className+=" "+this.cssSkin+"-Fixed",this.sFHeaderTable.className+=" "+this.cssSkin+"-FixedHeaders")),this.fixedCols>0&&this.sBase.appendChild(this.sFHeader),this.sHeader.appendChild(this.sHeaderInner),this.sBase.appendChild(this.sHeader),this.fixedCols>0&&(this.sFData.appendChild(this.sFDataInner),this.sBase.appendChild(this.sFData)),this.sBase.appendChild(this.sData),this.sParent.insertBefore(this.sBase,this.sDataTable),this.sData.appendChild(this.sDataTable);var k,l;this.sHeaderHeight=this.sDataTable.tBodies[0].rows[this.sDataTable.tHead?0:this.headerRows].offsetTop,l="margin-top: "+-1*this.sHeaderHeight+"px;",k="margin-top: "+this.sHeaderHeight+"px;",k+="height: "+(this.sParentHeight-this.sHeaderHeight)+"px;",this.fixedCols>0?(this.sFHeaderWidth=this.sDataTable.tBodies[0].rows[f].cells[this.fixedCols].offsetLeft,window.getComputedStyle&&(c=document.defaultView,d=this.sDataTable.tBodies[0].rows[0].cells[0],this.sFHeaderWidth+=navigator.taintEnabled?Math.ceil(parseInt(c.getComputedStyle(d,null).getPropertyValue("border-right-width"))/2):parseInt(c.getComputedStyle(d,null).getPropertyValue("border-right-width"))),window.opera&&(this.sFData.style.height=this.sParentHeight+"px"),this.sFHeader.style.width=this.sFHeaderWidth+"px",l+="margin-left: "+-1*this.sFHeaderWidth+"px;",k+="margin-left: "+this.sFHeaderWidth+"px;",k+="width: "+(this.sParentWidth-this.sFHeaderWidth)+"px;"):k+="width: "+this.sParentWidth+"px;",this.sData.style.cssText=k,this.sDataTable.style.cssText=l,function(a){a.sData.onscroll=a.fixedCols>0?function(){a.sHeaderInner.style.right=a.sData.scrollLeft+"px",a.sFDataInner.style.top=-1*a.sData.scrollTop+"px"}:function(){a.sHeaderInner.style.right=a.sData.scrollLeft+"px"}}(this),this.callbackFunc&&this.callbackFunc()};